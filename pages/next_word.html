<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Predict Fuel Efficiency with Machine Learning</title>
    <link rel="stylesheet" href="../style/style.css" />
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        margin: 0;
        padding: 10px;
        transition: background-color 0.3s, color 0.3s;
        font-size: 20px;
        
      }
      .content {
        margin: 20px auto;
        padding: 20px;
      }
      h1,
      h2,
      h3 {
        color: #2c3e50;
        transition: color 0.3s;
      }
      code {
        background-color: #f4f4f4;
        border: 1px solid #ddd;
        border-radius: 4px;
        display: block;
        padding: 10px;
        white-space: pre-wrap;
        font-size: 20px;
        transition: background-color 0.3s, border-color 0.3s;
      }
      /* css for mouse cursor trail effect */
      .circle {
        position: absolute;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        pointer-events: none;
        background: radial-gradient(
          circle,
          rgba(70, 130, 180, 0.3),
          skyblue,
          rgba(0, 0, 50, 0.3),
          white
        );
        transition: transform 0.1s, left 0.1s, top 0.1s;
      }

      .circle-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999; /* removed the non-breaking space (&nbsp;) */
      }
      .note {
        background-color: #e7f3fe;
        border-left: 6px solid #2196f3;
        margin-bottom: 15px;
        padding: 4px 12px;
        transition: background-color 0.3s, border-left-color 0.3s;
      }

      footer {
        background-color: #333;
        color: white;
        text-align: center;
        padding: 20px 0;
        margin-top: auto;
      }

      .footer-container {
        max-width: 800px;
        margin: auto;
        padding: 0 20px;
      }

      .footer-links,
      .footer-socials,
      .footer-contact {
        margin: 10px 0;
      }

      .footer-links a,
      .footer-socials a {
        color: white;
        text-decoration: none;
        margin: 0 10px;
        transition: color 0.3s;
      }

      .footer-links a:hover,
      .footer-socials a:hover {
        color: #007bff;
      }

      .footer-socials a {
        font-size: 24px;
        margin: 0 15px;
      }

      .footer-contact a {
        color: white;
      }

      .ani {
        display: flex;
        padding: 0.5em 0;
        justify-content: center;
        align-items: center;
        background-color: #4a90e2;
        color: white;
        font-weight: bold;
        text-align: center;
        animation: colorChange 8s infinite;
      }
      body.dark-mode .ani {
        color: #1c2e3e;
      }
      @keyframes colorChange {
        0% {
          background-color: #4a90e2;
        }
        50% {
          background-color: #50b3a2;
        }
        100% {
          background-color: #4a90e2;
        }
      }

      /* Dark mode styles */
      body.dark-mode {
        background-color: #1a1a1a;
        color: #f0f0f0;
      }
      body.dark-mode h1,
      body.dark-mode h2,
      body.dark-mode h3 {
        color: #58a6ff;
      }
      body.dark-mode code {
        background-color: #2b2b2b;
        border-color: #444;
        color: #e6e6e6;
      }
      body.dark-mode .note {
        background-color: #1c2e3e;
        border-left-color: #58a6ff;
      }
      body.dark-mode header {
        background-color: #2c2c2c;
      }
      body.dark-mode nav ul li a {
        color: #f0f0f0;
      }
      #scrollTopBtn {
        display: none;
        position: fixed;
        bottom: 20px;
        right: 105px;
        z-index: 99;
        font-size: 26px;
        background-color: #00bfff;
        color: white;
        border: none;
        padding: 15px;
        border-radius: 50%;
      }

      #scrollTopBtn:hover {
        background-color: #555;
      }
    </style>
  </head>
  <body>
    <div class="circle-container">
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
    </div>
    <header>
      <div class="logo">
        <a href="../index.html">
          <h1>
            <img
              src="../image/ml fusion lab log.jpg"
              alt="logo"
              width="100"
              height="100"
            />
          </h1>
        </a>
      </div>
      <nav>
        <div class="hamburger" id="hamburger">&#9776;</div>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="../pages/courses.html">Courses</a></li>
          <li><a href="../pages/projects.html">Projects</a></li>
          <li><a href="../pages/about.html">About Us</a></li>
          <li><a href="../pages/contact.html">Contact</a></li>
          <li>
            <a href="../pages/community_suport.html">Community Support</a>
          </li>
          <li><a href="../pages/feedback.html">Feedback</a></li>
          <div id="theme-switch" style="cursor: pointer;">ðŸŒ™</div>

        </ul>
      </nav>
    </header>

    <div class="content">
        <h1 class="ani">NLP Word Prediction</h1>
        <p>This webpage provides a detailed explanation of the Python code that implements a word prediction model using an LSTM neural network. The model is trained on text data to predict the next word in a sequence.</p>

        <h2>1. Importing Libraries</h2>
        <p>The first step is importing the necessary libraries for the task.</p>
        <pre><code>import numpy as np
from nltk.tokenize import RegexpTokenizer
from keras.models import Sequential, load_model
from keras.layers import LSTM
from keras.layers.core import Dense, Activation
from keras.optimizers import RMSprop
import matplotlib.pyplot as plt
import pickle
import heapq</code></pre>
        <p><b>Explanation:</b></p>
        <ul>
            <li>numpy: For handling numerical operations and arrays.</li>
            <li>RegexpTokenizer: Tokenizes text into words using regular expressions.</li>
            <li>Keras: To create the neural network (LSTM) for word prediction.</li>
            <li>matplotlib: Used for plotting graphs to visualize the model's performance.</li>
            <li>pickle: For saving and loading model history.</li>
            <li>heapq: For extracting the top-n predictions.</li>
        </ul>

        <h2>2. Reading and Tokenizing the Text</h2>
        <p>The code reads the text from a file and tokenizes it into individual words.</p>
        <pre><code>path = '1661-0.txt'
text = open(path).read().lower()
print('corpus length:', len(text))

tokenizer = RegexpTokenizer(r'w+')
words = tokenizer.tokenize(text)</code></pre>
        <p><b>Explanation:</b> The file 1661-0.txt is loaded and converted to lowercase. Then, the words are tokenized using RegexpTokenizer.</p>

        <h2>3. Preparing the Dataset</h2>
        <p>The following code creates the dataset used to train the model. It generates sequences of words and their next word (as the target).</p>
        <pre><code>unique_words = np.unique(words)
unique_word_index = dict((c, i) for i, c in enumerate(unique_words))

WORD_LENGTH = 5
prev_words = []
next_words = []
for i in range(len(words) - WORD_LENGTH):
    prev_words.append(words[i:i + WORD_LENGTH])
    next_words.append(words[i + WORD_LENGTH])
</code></pre>
        <p><b>Explanation:</b> The code generates unique words and their indices. It creates sequences of 5 words (input) and the next word (output).</p>

        <h2>4. Vectorization</h2>
        <p>The sequences and target words are converted into binary matrices that the LSTM model can understand.</p>
        <pre><code>X = np.zeros((len(prev_words), WORD_LENGTH, len(unique_words)), dtype=bool)
Y = np.zeros((len(next_words), len(unique_words)), dtype=bool)
for i, each_words in enumerate(prev_words):
    for j, each_word in enumerate(each_words):
        X[i, j, unique_word_index[each_word]] = 1
    Y[i, unique_word_index[next_words[i]]] = 1
</code></pre>
        <p><b>Explanation:</b> Each word sequence is converted into a binary matrix of 0s and 1s for input X and target Y.</p>

        <h2>5. Building the LSTM Model</h2>
        <p>The model is created using Keras. An LSTM layer is added, followed by a Dense layer and a softmax activation function for word prediction.</p>
        <pre><code>model = Sequential()
model.add(LSTM(128, input_shape=(WORD_LENGTH, len(unique_words))))
model.add(Dense(len(unique_words)))
model.add(Activation('softmax'))

optimizer = RMSprop(lr=0.01)
model.compile(loss='categorical_crossentropy', optimizer=optimizer, metrics=['accuracy'])</code></pre>
        <p><b>Explanation:</b> The LSTM network learns from the input sequences and outputs probabilities for the next word using the softmax function. The model is optimized using RMSprop, and categorical cross-entropy is used as the loss function.</p>

        <h2>6. Training the Model</h2>
        <p>The model is trained using the prepared dataset for 2 epochs, with a batch size of 128.</p>
        <pre><code>history = model.fit(X, Y, validation_split=0.05, batch_size=128, epochs=2, shuffle=True).history

model.save('keras_next_word_model.h5')
pickle.dump(history, open("history.p", "wb"))
</code></pre>
        <p><b>Explanation:</b> The model is trained, and its accuracy and loss over time are saved. The trained model and its history are saved for future use.</p>

        <h2>7. Visualizing the Model's Performance</h2>
        <p>After training, the model's accuracy and loss are plotted using Matplotlib.</p>
        <pre><code>plt.plot(history['acc'])
plt.plot(history['val_acc'])
plt.title('model accuracy')
plt.ylabel('accuracy')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')

plt.plot(history['loss'])
plt.plot(history['val_loss'])
plt.title('model loss')
plt.ylabel('loss')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')
</code></pre>
        <p><b>Explanation:</b> The accuracy and loss are plotted to observe how well the model is performing on both training and validation data.</p>

        <h2>8. Making Predictions</h2>
        <p>The model can now predict the next word given a sequence of words. This is achieved by the <code>prepare_input</code> and <code>predict_completion</code> functions.</p>
        <pre><code>def prepare_input(text):
    x = np.zeros((1, WORD_LENGTH, len(unique_words)))
    for t, word in enumerate(text.split()):
        x[0, t, unique_word_index[word]] = 1
    return x

def sample(preds, top_n=3):
    preds = np.asarray(preds).astype('float64')
    preds = np.log(preds)
    exp_preds = np.exp(preds)
    preds = exp_preds / np.sum(exp_preds)

    return heapq.nlargest(top_n, range(len(preds)), preds.take)
</code></pre>
        <p><b>Explanation:</b> The <code>prepare_input</code> function converts input text into a format the model can process. The <code>sample</code> function returns the top-n predicted words.</p>

        <h2>9. Predicting Completions</h2>
        <p>The code can now predict multiple possible completions for a given sentence.</p>
        <pre><code>def predict_completions(text, n=3):
    x = prepare_input(text)
    preds = model.predict(x, verbose=0)[0]
    next_indices = sample(preds, n)
    return [indices_char[idx] + predict_completion(text[1:] + indices_char[idx]) for idx in next_indices]

quotes = [
    "It is not a lack of love, but a lack of friendship that makes unhappy marriages.",
    "That which does not kill us makes us stronger.",
]

for q in quotes:
    seq = q[:40].lower()
    print(seq)
    print(predict_completions(seq, 5))
    print()
</code></pre>
        <p><b>Explanation:</b> Given a sequence of words, the model predicts multiple possible completions. The <code>predict_completions</code> function returns a list of predicted next words.</p>

    </div>
    <footer>
        <div class="container">
          <div class="footer-socials">
            Follow us on:
            <a href="https://facebook.com" target="_blank">
              <svg
                style="width: 10px"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 320 512"
              >
                <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                <path
                  fill="#ffffff"
                  d="M80 299.3V512H196V299.3h86.5l18-97.8H196V166.9c0-51.7 20.3-71.5 72.7-71.5c16.3 0 29.4 .4 37 1.2V7.9C291.4 4 256.4 0 236.2 0C129.3 0 80 50.5 80 159.4v42.1H14v97.8H80z"
                />
              </svg>
            </a>
            <a href="https://twitter.com" target="_blank"
              ><svg
                style="width: 15px"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 512 512"
              >
                <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                <path
                  fill="#ffffff"
                  d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"
                />
              </svg>
            </a>
            <a href="https://linkedin.com" target="_blank">
              <svg
                style="width: 15px"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 448 512"
              >
                <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                <path
                  fill="#ffffff"
                  d="M100.3 448H7.4V148.9h92.9zM53.8 108.1C24.1 108.1 0 83.5 0 53.8a53.8 53.8 0 0 1 107.6 0c0 29.7-24.1 54.3-53.8 54.3zM447.9 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448z"
                />
              </svg>
            </a>
          </div>
          <div class="footer-contact">
            <div>
              Contact us:
              <a href="mailto:info@mlfusionlabs.com" style="color: white"
                >info@mlfusionlabs.com</a
              >
              | Phone: +1 (555) 123-4567
            </div>
          </div>
          <div class="footer-links">
            <a href="../pages/privacy.html">Privacy Policy</a> |
            <a href="../pages/terms.html">Terms of Service</a> |
            <a href="../pages/about.html">About Us</a> |
            <a href="../pages/contact.html">Contact</a> |
            <a href="../pages/contributor.html">Contributor</a>
          </div>
          <div>
            &copy; <span id="current-year"></span> ML Fusion Labs | All Rights
            Reserved
          </div>
        </div>
        <button id="scrollTopBtn" onclick="scrollToTop()">
          <svg
            style="width: 20px"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 384 512"
          >
            <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
            <path
              fill="#ffffff"
              d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2 160 448c0 17.7 14.3 32 32 32s32-14.3 32-32l0-306.7L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"
            />
          </svg>
        </button>
      </footer>
      <script>
        const scrollTopBtn = document.getElementById("scrollTopBtn");
        window.onscroll = function () {
          if (
            document.body.scrollTop > 20 ||
            document.documentElement.scrollTop > 20
          ) {
            scrollTopBtn.style.display = "block";
          } else {
            scrollTopBtn.style.display = "none";
          }
        };
    
        function scrollToTop() {
          window.scrollTo({
            top: 0,
            behavior: "smooth",
          });
        }
      </script>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          const coords = { x: 0, y: 0 };
          const circles = document.querySelectorAll(".circle");
    
          circles.forEach(function (circle, index) {
            circle.x = 0;
            circle.y = 0;
          });
    
          window.addEventListener("mousemove", function (e) {
            coords.x = e.clientX;
            coords.y = e.clientY;
          });
    
          function animateCircles() {
            let x = coords.x;
            let y = coords.y;
    
            circles.forEach(function (circle, index) {
              circle.style.left = x + "px";
              circle.style.top = y + "px";
    
              circle.style.scale = (circles.length - index) / circles.length;
              circle.x = x;
              circle.y = y;
    
              const nextCircle = circles[index + 1] || circles[0];
              x += (nextCircle.x - x) * 0.3;
              y += (nextCircle.y - y) * 0.3;
            });
    
            requestAnimationFrame(animateCircles);
          }
    
          animateCircles();
        });
      </script>
      <script src="../script/scroll.js"></script>
      <script src="../script/script.js"></script>
      <script src="../script/projects.js"></script>
      <script src="https://cdn.botpress.cloud/webchat/v2.2/inject.js"></script>
      <script src="https://files.bpcontent.cloud/2024/10/06/10/20241006104845-C8MQIMON.js"></script>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          const themeSwitch = document.getElementById("theme-switch");
      
          if (localStorage.getItem("theme") === "dark") {
            document.body.classList.add("dark-mode");
          }
      
          themeSwitch.addEventListener("click", function () {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem(
              "theme",
              document.body.classList.contains("dark-mode") ? "dark" : "light"
            );
          });
        });
      </script>
    </body>
    </html>
    
