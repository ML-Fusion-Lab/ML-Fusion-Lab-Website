<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fashion Recommendation System</title>
  <link rel="stylesheet" href="../style/style.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      margin: 0;
      padding: 10px;
      transition: background-color 0.3s, color 0.3s;
      font-size: 20px;

    }

    .content {
      margin: 20px auto;
      padding: 20px;
    }

    h1,
    h2,
    h3 {
      color: #2c3e50;
      transition: color 0.3s;
    }

    code {
      background-color: #f4f4f4;
      border: 1px solid #ddd;
      border-radius: 4px;
      display: block;
      padding: 10px;
      white-space: pre-wrap;
      font-size: 20px;
      transition: background-color 0.3s, border-color 0.3s;
    }

    /* css for mouse cursor trail effect */
    .circle {
      position: absolute;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      pointer-events: none;
      background: radial-gradient(circle,
          rgba(70, 130, 180, 0.3),
          skyblue,
          rgba(0, 0, 50, 0.3),
          white);
      transition: transform 0.1s, left 0.1s, top 0.1s;
    }

    .circle-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
      /* removed the non-breaking space (&nbsp;) */
    }

    .note {
      background-color: #e7f3fe;
      border-left: 6px solid #2196f3;
      margin-bottom: 15px;
      padding: 4px 12px;
      transition: background-color 0.3s, border-left-color 0.3s;
    }

    footer {
      background-color: #333;
      color: white;
      text-align: center;
      padding: 20px 0;
      margin-top: auto;
    }

    .footer-container {
      max-width: 800px;
      margin: auto;
      padding: 0 20px;
    }

    .footer-links,
    .footer-socials,
    .footer-contact {
      margin: 10px 0;
    }

    .footer-links a,
    .footer-socials a {
      color: white;
      text-decoration: none;
      margin: 0 10px;
      transition: color 0.3s;
    }

    .footer-links a:hover,
    .footer-socials a:hover {
      color: #007bff;
    }

    .footer-socials a {
      font-size: 24px;
      margin: 0 15px;
    }

    .footer-contact a {
      color: white;
    }

    .ani {
      display: flex;
      padding: 0.5em 0;
      justify-content: center;
      align-items: center;
      background-color: #4a90e2;
      color: white;
      font-weight: bold;
      text-align: center;
      animation: colorChange 8s infinite;
    }

    body.dark-mode .ani {
      color: #1c2e3e;
    }

    @keyframes colorChange {
      0% {
        background-color: #4a90e2;
      }

      50% {
        background-color: #50b3a2;
      }

      100% {
        background-color: #4a90e2;
      }
    }

    /* Dark mode styles */
    body.dark-mode {
      background-color: #1a1a1a;
      color: #f0f0f0;
    }

    body.dark-mode h1,
    body.dark-mode h2,
    body.dark-mode h3 {
      color: #58a6ff;
    }

    body.dark-mode code {
      background-color: #2b2b2b;
      border-color: #444;
      color: #e6e6e6;
    }

    body.dark-mode .note {
      background-color: #1c2e3e;
      border-left-color: #58a6ff;
    }

    body.dark-mode header {
      background-color: #2c2c2c;
    }

    body.dark-mode nav ul li a {
      color: #f0f0f0;
    }

    #scrollTopBtn {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 105px;
      z-index: 99;
      font-size: 26px;
      background-color: #00bfff;
      color: white;
      border: none;
      padding: 15px;
      border-radius: 50%;
    }

    #scrollTopBtn:hover {
      background-color: #555;
    }
  </style>
</head>

<body>
  <div class="circle-container">
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
  </div>
  <header>
    <div class="logo">
      <a href="../index.html">
        <h1>
          <img src="../image/ml fusion lab log.jpg" alt="logo" width="100" height="100" />
        </h1>
      </a>
    </div>
    <nav>
      <div class="hamburger" id="hamburger">&#9776;</div>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../pages/courses.html">Courses</a></li>
        <li><a href="../pages/projects.html">Projects</a></li>
        <li><a href="../pages/about.html">About Us</a></li>
        <li><a href="../pages/contact.html">Contact</a></li>
        <li>
          <a href="../pages/community_suport.html">Community Support</a>
        </li>
        <li><a href="../pages/feedback.html">Feedback</a></li>
        <div id="theme-switch" style="cursor: pointer;">ðŸŒ™</div>

      </ul>
    </nav>
  </header>

  <div class="content">
    <h1 class="ani">Fashion Recommendation System Using Deep Learning</h1>

    <div class="section">
      <h2>Overview</h2>
      <p>This project implements a fashion recommendation system using deep learning. It utilizes transfer learning with
        ResNet models to extract features from fashion images and creates recommendations based on similarity metrics.
        The system is built using FastAI, PyTorch, and Spotify's Annoy library for efficient similarity search.</p>

      <h3>Required Libraries</h3>
      <div class="code-block">
        <div class="code-header">Dependencies</div>
        <pre><code>import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import gdown
from fastai.vision import *
from fastai.metrics import accuracy, top_k_accuracy
from annoy import AnnoyIndex
import zipfile
import time
from google.colab import drive</code></pre>
      </div>
    </div>

    <div class="section">
      <h2>Implementation Steps</h2>

      <div class="step">
        <h3>1. Data Preparation</h3>
        <p>Downloads and prepares the fashion dataset:</p>
        <div class="code-block">
          <div class="code-header">Downloading Dataset Files</div>
          <pre><code># Download metadata files
url = 'https://drive.google.com/uc?id=0B7EVK8r0v71pWnFiNlNGTVloLUk'
output = 'list_category_cloth.txt'
gdown.download(url, output, quiet=False)

# Download and extract images
root_path = './'
url = 'https://drive.google.com/uc?id=1j5fCPgh0gnY6v7ChkWlgnnHH6unxuAbb'
output = 'img.zip'
gdown.download(url, output, quiet=False)
with zipfile.ZipFile("img.zip","r") as zip_ref:
    zip_ref.extractall(root_path)</code></pre>
        </div>
      </div>

      <div class="step">
        <h3>2. Data Processing</h3>
        <p>Processes the data into a structured format:</p>
        <div class="code-block">
          <div class="code-header">Data Processing and Organization</div>
          <pre><code># Create DataFrame with image information
data_df = pd.DataFrame(image_path_list, columns=['image_path', 'category_number'])
data_df['category_number'] = data_df['category_number'].astype(int)
data_df = data_df.merge(
    pd.DataFrame(data_type_list, columns=['image_path', 'dataset_type']), 
    on='image_path'
)
data_df['category'] = data_df['category_number'].apply(
    lambda x: category_list[int(x) - 1]
)

# Create FastAI ImageList objects
train_image_list = ImageList.from_df(
    df=data_df, 
    path=root_path, 
    cols='image_path'
).split_by_idxs(
    (data_df[data_df['dataset_type']=='train'].index),
    (data_df[data_df['dataset_type']=='val'].index)
).label_from_df(cols='category')</code></pre>
        </div>
      </div>

      <div class="step">
        <h3>3. Model Training</h3>
        <p>Implements transfer learning with ResNet:</p>
        <div class="code-block">
          <div class="code-header">Model Training Setup</div>
          <pre><code>def train_model(data, pretrained_model, model_metrics):
    learner = cnn_learner(data, pretrained_model, metrics=model_metrics)
    learner.model = torch.nn.DataParallel(learner.model)
    learner.lr_find()
    learner.recorder.plot(suggestion=True)
    return learner

# Setup and train the model
pretrained_model = models.resnet18
model_metrics = [
    accuracy, 
    partial(top_k_accuracy, k=1), 
    partial(top_k_accuracy, k=5)
]
learner = train_model(data, pretrained_model, model_metrics)
learner.fit_one_cycle(10, max_lr=1e-02)</code></pre>
        </div>
      </div>

      <div class="step">
        <h3>4. Feature Extraction</h3>
        <p>Extracts embeddings from the trained model:</p>
        <div class="code-block">
          <div class="code-header">Feature Extraction Implementation</div>
          <pre><code>class SaveFeatures():
    features=None
    def __init__(self, m): 
        self.hook = m.register_forward_hook(self.hook_fn)
        self.features = None
    def hook_fn(self, module, input, output): 
        out = output.detach().cpu().numpy()
        if isinstance(self.features, type(None)):
            self.features = out
        else:
            self.features = np.row_stack((self.features, out))
    def remove(self): 
        self.hook.remove()

# Extract features
saved_features = SaveFeatures(learner.model.module[1][4])
_= learner.get_preds(data.train_ds)
_= learner.get_preds(DatasetType.Valid)</code></pre>
        </div>
      </div>

      <div class="step">
        <h3>5. Recommendation System</h3>
        <p>Implements similarity-based recommendations using Annoy:</p>
        <div class="code-block">
          <div class="code-header">Recommendation System Implementation</div>
          <pre><code>def get_similar_images_annoy(annoy_tree, img_index, number_of_items=12):
    start = time.time()
    img_id, img_label = data_df_ouput.iloc[img_index, [0, 1]]
    similar_img_ids = annoy_tree.get_nns_by_item(img_index, number_of_items+1)
    end = time.time()
    print(f'{(end - start) * 1000} ms')
    return img_id, img_label, data_df_ouput.iloc[similar_img_ids[1:]]

# Build Annoy index
ntree = 100
metric_choice = 'angular'
annoy_tree = AnnoyIndex(len(data_df_ouput['embeddings'][0]), metric=metric_choice)

for i, vector in enumerate(data_df_ouput['embeddings']):
    annoy_tree.add_item(i, vector)
_ = annoy_tree.build(ntree)</code></pre>
        </div>
      </div>

      <div class="step">
        <h3>6. Centroid-based Recommendations</h3>
        <p>Implements recommendations based on multiple reference images:</p>
        <div class="code-block">
          <div class="code-header">Centroid-based Recommendation Implementation</div>
          <pre><code>def centroid_embedding(outfit_embedding_list):
    number_of_outfits = outfit_embedding_list.shape[0]
    length_of_embedding = outfit_embedding_list.shape[1]
    centroid = []
    for i in range(length_of_embedding):
        centroid.append(np.sum(outfit_embedding_list[:, i])/number_of_outfits)
    return centroid

def get_similar_images_annoy_centroid(annoy_tree, vector_value, number_of_items=12):
    start = time.time()
    similar_img_ids = annoy_tree.get_nns_by_vector(vector_value, number_of_items+1)
    end = time.time()
    print(f'{(end - start) * 1000} ms')
    return data_df_ouput.iloc[similar_img_ids[1:]]</code></pre>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Technical Requirements</h2>
      <div class="warning">
        <strong>Note:</strong> The code requires:
        <ul>
          <li>Python with PyTorch, FastAI, and Annoy libraries</li>
          <li>Sufficient GPU memory for model training</li>
          <li>Google Drive integration for model storage</li>
          <li>Adequate storage for the fashion dataset</li>
        </ul>
      </div>
    </div>

    <div class="section">
      <h2>Usage Example</h2>
      <div class="code-block">
        <div class="code-header">Finding Similar Items</div>
        <pre><code># Find similar items to a group of shorts
outfit_img_ids = [109938, 106385, 113703, 98666, 113467, 120667]
outfit_embedding_list = []
for img_index in outfit_img_ids:
    outfit_embedding_list.append(data_df_ouput.iloc[img_index, 3])

outfit_embedding_list = np.array(outfit_embedding_list)
outfit_centroid_embedding = centroid_embedding(outfit_embedding_list)
similar_images_df = get_similar_images_annoy_centroid(
    annoy_tree, 
    outfit_centroid_embedding, 
    30
)

# Display results
show_similar_images(similar_images_df, fig_size=[15,15])</code></pre>
      </div>
    </div>
    <footer>
      <div class="container">
        <div class="footer-socials">
          Follow us on:
          <a href="https://facebook.com" target="_blank">
            <svg style="width: 10px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
              <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
              <path fill="#ffffff"
                d="M80 299.3V512H196V299.3h86.5l18-97.8H196V166.9c0-51.7 20.3-71.5 72.7-71.5c16.3 0 29.4 .4 37 1.2V7.9C291.4 4 256.4 0 236.2 0C129.3 0 80 50.5 80 159.4v42.1H14v97.8H80z" />
            </svg>
          </a>
          <a href="https://twitter.com" target="_blank"><svg style="width: 15px" xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 512 512">
              <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
              <path fill="#ffffff"
                d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z" />
            </svg>
          </a>
          <a href="https://linkedin.com" target="_blank">
            <svg style="width: 15px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
              <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
              <path fill="#ffffff"
                d="M100.3 448H7.4V148.9h92.9zM53.8 108.1C24.1 108.1 0 83.5 0 53.8a53.8 53.8 0 0 1 107.6 0c0 29.7-24.1 54.3-53.8 54.3zM447.9 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448z" />
            </svg>
          </a>
        </div>
        <div class="footer-contact">
          <div>
            Contact us:
            <a href="mailto:info@mlfusionlabs.com" style="color: white">info@mlfusionlabs.com</a>
            | Phone: +1 (555) 123-4567
          </div>
        </div>
        <div class="footer-links">
          <a href="../pages/privacy.html">Privacy Policy</a> |
          <a href="../pages/terms.html">Terms of Service</a> |
          <a href="../pages/about.html">About Us</a> |
          <a href="../pages/contact.html">Contact</a> |
          <a href="../pages/contributor.html">Contributor</a>
        </div>
        <div>
          &copy; <span id="current-year"></span> ML Fusion Labs | All Rights
          Reserved
        </div>
      </div>
      <button id="scrollTopBtn" onclick="scrollToTop()">
        <svg style="width: 20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
          <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
          <path fill="#ffffff"
            d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2 160 448c0 17.7 14.3 32 32 32s32-14.3 32-32l0-306.7L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z" />
        </svg>
      </button>
    </footer>
    <script>
      const scrollTopBtn = document.getElementById("scrollTopBtn");
      window.onscroll = function () {
        if (
          document.body.scrollTop > 20 ||
          document.documentElement.scrollTop > 20
        ) {
          scrollTopBtn.style.display = "block";
        } else {
          scrollTopBtn.style.display = "none";
        }
      };

      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const coords = { x: 0, y: 0 };
        const circles = document.querySelectorAll(".circle");

        circles.forEach(function (circle, index) {
          circle.x = 0;
          circle.y = 0;
        });

        window.addEventListener("mousemove", function (e) {
          coords.x = e.clientX;
          coords.y = e.clientY;
        });

        function animateCircles() {
          let x = coords.x;
          let y = coords.y;

          circles.forEach(function (circle, index) {
            circle.style.left = x + "px";
            circle.style.top = y + "px";

            circle.style.scale = (circles.length - index) / circles.length;
            circle.x = x;
            circle.y = y;

            const nextCircle = circles[index + 1] || circles[0];
            x += (nextCircle.x - x) * 0.3;
            y += (nextCircle.y - y) * 0.3;
          });

          requestAnimationFrame(animateCircles);
        }

        animateCircles();
      });
    </script>
    <script src="../script/scroll.js"></script>
    <script src="../script/script.js"></script>
    <script src="../script/projects.js"></script>
    <script>
      window.embeddedChatbotConfig = {
        chatbotId: "rKhBc1qcW7yrIovRvB5c4",
        domain: "www.chatbase.co"
      }
    </script>
    <script src="https://www.chatbase.co/embed.min.js" chatbotId="rKhBc1qcW7yrIovRvB5c4" domain="www.chatbase.co" defer>
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const themeSwitch = document.getElementById("theme-switch");

        if (localStorage.getItem("theme") === "dark") {
          document.body.classList.add("dark-mode");
        }

        themeSwitch.addEventListener("click", function () {
          document.body.classList.toggle("dark-mode");
          localStorage.setItem(
            "theme",
            document.body.classList.contains("dark-mode") ? "dark" : "light"
          );
        });
      });
    </script>
</body>

</html>